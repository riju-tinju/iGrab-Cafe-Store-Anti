<style>
    /* Profile Dashboard */
    .profile-dashboard {
        position: fixed;
        top: 0;
        right: 0;
        width: 100%;
        height: 100vh;
        background-color: white;
        z-index: 100;
        transform: translateX(100%);
        transition: transform 0.3s ease;
    }

    .profile-dashboard.active {
        transform: translateX(0);
    }

    /* Desktop Optimizations */
    @media (min-width: 1024px) {
        .profile-dashboard {
            width: 400px;
        }
    }
</style>
<div class="profile-dashboard" id="profile-dashboard">
    <div class="p-6">
        <div class="flex justify-between items-center mb-6">
            <h2 class="text-2xl font-bold">Your Profile</h2>
            <button id="close-profile-btn" class="text-2xl">
                <i class="fas fa-times"></i>
            </button>
        </div>

        <!-- Profile Header -->
        <% if (customer.user=='guest' ) { %>
            <div class="flex items-center mb-8">
                <div
                    class="w-20 h-20 bg-primary rounded-full flex items-center justify-center text-white text-3xl mr-4">
                    <i class="fas fa-user"></i>
                </div>
                <div>
                    <h3 class="text-xl font-bold">Guest User</h3>
                    <p class="text-gray-500">Sign in to access your account</p>
                    <div class="mt-2">
                        <button class="btn-primary text-sm py-1 px-4" onclick="openPage('/login')">Sign In</button>
                        <button class="ml-2 text-sm text-accent" onclick="openPage('/login')">Sign Up</button>
                    </div>
                </div>
            </div>
            <% }else{ %>
                <div class="flex items-center mb-8">
                    <div class="w-20 h-20 bg-primary rounded-full flex items-center justify-center text-white text-3xl mr-4"
                        style="background-image: url('<%= customer?.profilePicture || '/images/default-profile.png' %>'); background-size: cover; background-position: center;">
                        <i class="fas fa-user"></i>
                    </div>
                    <div>
                        <h3 class="text-xl font-bold">
                            <%= customer?.name %>
                        </h3>
                        <!-- <p class="text-gray-500">Sign in to access your account</p> -->
                        <!-- <div class="mt-2">
                        <button class="btn-primary text-sm py-1 px-4">Sign In</button>
                        <button class="ml-2 text-sm text-accent">Sign Up</button>
                    </div> -->
                    </div>
                </div>
                <% } %>
                    <!-- Loyalty Section -->
                    <!-- <div class="bg-accent bg-opacity-20 rounded-xl p-4 mb-8">
                <div class="flex justify-between items-center mb-2">
                    <h3 class="font-bold">Loyalty Rewards</h3>
                    <span class="text-sm text-accent">0 Points</span>
                </div>
                <div class="w-full bg-white rounded-full h-2 mb-2">
                    <div class="bg-accent h-2 rounded-full" style="width: 0%"></div>
                </div>
                <p class="text-sm text-gray-500">Sign in to start earning rewards</p>
            </div> -->

                    <!-- Quick Links -->
                    <div class="space-y-4">
                        <% if (customer.user !=='user' ) { %>
                            <a href="#" id="order-history-btn" class="flex justify-between items-center p-4 bg-white rounded-xl shadow-sm">
                                <div class="flex items-center">
                                    <i class="fas fa-history text-lg text-primary mr-3"></i>
                                    <span>Order History</span>
                                </div>
                                <i class="fas fa-chevron-right text-gray-400"></i>
                            </a>
                            <style>
                                .order-history-container {
                                    height: auto;
                                    width: 100%;
                                    background: #f4f4f4;
                                    border-radius: 6px;
                                    overflow: hidden;
                                    overflow-y: hidden;
                                    overflow-y: scroll;
                                }

                                .order-history-container.hidden {
                                    display: none;
                                }

                                .order-history-container.active {
                                    display: block;
                                }
                            </style>
                            <div class="order-history-container">
                                <!-- Order Card -->
                                <div class="order-card border rounded-xl p-4 shadow-sm bg-white">
                                    <!-- Order Header -->
                                    <div class="flex justify-between items-center">
                                        <div>
                                            <p class="text-sm font-semibold text-gray-700">Order ID: <span
                                                    class="text-black">ORD12345</span></p>
                                            <p class="text-xs text-gray-500">Placed on: Jun 4, 2025</p>
                                        </div>
                                        <div>
                                            <span
                                                class="text-xs px-2 py-1 bg-green-100 text-green-700 rounded">Delivered</span>
                                        </div>
                                    </div>

                                    <!-- Products Summary -->
                                    <div class="mt-3 space-y-2">
                                        <!-- Theese contents only show when user click the View
                                            Items button -->
                                        <!-- <div class="flex items-center gap-3">
                                            <img src="https://..." class="w-12 h-12 rounded object-cover" />
                                            <div>
                                                <p class="text-sm font-medium">Vanilla Latte</p>
                                                <p class="text-xs text-gray-500">Qty: 2 × AED 25</p>
                                            </div>
                                        </div>
                                        <div class="flex items-center gap-3">
                                            <img src="https://..." class="w-12 h-12 rounded object-cover" />
                                            <div>
                                                <p class="text-sm font-medium">Croissant Classic</p>
                                                <p class="text-xs text-gray-500">Qty: 1 × AED 12</p>
                                            </div>
                                        </div> -->
                                        <button class="text-xs text-blue-600 underline hover:text-blue-800">View
                                            Items</button>
                                    </div>

                                    <!-- Total & Action -->
                                    <div class="mt-4 flex justify-between items-center border-t pt-2">
                                        <p class="text-sm font-semibold">Total: AED 62</p>                           
                                    </div>
                                </div>
                            </div>

                            <!-- <a href="#" class="flex justify-between items-center p-4 bg-white rounded-xl shadow-sm">
                    <div class="flex items-center">
                        <i class="fas fa-map-marker-alt text-lg text-primary mr-3"></i>
                        <span>Saved Addresses</span>
                    </div>
                    <i class="fas fa-chevron-right text-gray-400"></i>
                </a> -->

                            <!-- <a href="#" class="flex justify-between items-center p-4 bg-white rounded-xl shadow-sm">
                    <div class="flex items-center">
                        <i class="fas fa-credit-card text-lg text-primary mr-3"></i>
                        <span>Payment Methods</span>
                    </div>
                    <i class="fas fa-chevron-right text-gray-400"></i>
                </a> -->

                            <!-- <a href="#" class="flex justify-between items-center p-4 bg-white rounded-xl shadow-sm">
                    <div class="flex items-center">
                        <i class="fas fa-bell text-lg text-primary mr-3"></i>
                        <span>Notifications</span>
                    </div>
                    <i class="fas fa-chevron-right text-gray-400"></i>
                </a> -->

                            <a id="logOut-btn"
                                class="flex justify-between items-center p-4 bg-white rounded-xl shadow-sm">
                                <div class="flex items-center">
                                    <i style="color:red"
                                        class="fas fa-arrow-right-from-bracket text-lg text-primary mr-3"></i>
                                    <span style="color:red">Logout</span>
                                </div>
                                <!-- <i class="fas fa-chevron-right text-gray-400"></i> -->
                            </a>
                            <% } %>
                                <!-- <a href="#" class="flex justify-between items-center p-4 bg-white rounded-xl shadow-sm">
                    <div class="flex items-center">
                        <i class="fas fa-cog text-lg text-primary mr-3"></i>
                        <span>Settings</span>
                    </div>
                    <i class="fas fa-chevron-right text-gray-400"></i>
                </a> -->
                    </div>
    </div>
</div>
<script>
    document.getElementById('profile-btn').addEventListener('click', function () {
        document.getElementById('profile-dashboard').classList.toggle('active');
    });
    document.getElementById('close-profile-btn').addEventListener('click', function () {
        document.getElementById('profile-dashboard').classList.remove('active');
    });

    function openPage(url) {
        window.location.href = url
    }
</script>

<script>
    document.getElementById('logOut-btn').addEventListener('click', function () {
        fetch('/api/logout', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            }
        })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    window.location.href = '/';
                } else {

                    showToast('Logout failed. Please try again.');
                }
            })
            .catch(error => console.error('Error:', error));
    });
</script>